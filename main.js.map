{"version":3,"file":"main.js","mappings":"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","sources":["webpack://Testing/webpack/bootstrap","webpack://Testing/webpack/runtime/global","webpack://Testing/webpack/runtime/publicPath","webpack://Testing/./src/components/form-widget/form-widget.js","webpack://Testing/./src/js/validators/card-number-validator.js","webpack://Testing/./src/js/validators/pay-system-validator.js","webpack://Testing/./src/js/app.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && !scriptUrl) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","import './form-widget.css';\n\nimport isValidCard from '../../js/validators/card-number-validator';\nimport paySystem from '../../js/validators/pay-system-validator';\n\nimport visa from '../../img/visa.svg';\nimport mastercard from '../../img/mastercard.svg';\nimport americanExpress from '../../img/american-express.svg';\nimport discover from '../../img/discover.svg';\nimport jcb from '../../img/jcb.svg';\nimport mir from '../../img/mir.svg';\n\nexport default class CardFormWidget {\n    constructor(parentEl) {\n        this.parentEl = parentEl;\n\n        this.onSubmit = this.onSubmit.bind(this);\n        this.onInput = this.onInput.bind(this);\n\n        this.cardSystems = [\n            ['visa', visa, [4]], \n            ['mastercard', mastercard, [5]],\n            ['american-express', americanExpress, [37]],\n            ['discover', discover, [60, 65]],\n            ['jcb', jcb, [35]],\n            ['mir', mir, [22]],\n        ];\n\n        this.currentCardSystem = null;\n    }\n    \n    static markup(cardSystems) {\n        const cardFormWidget = document.createElement('form');\n        cardFormWidget.classList.add(\"card-form-widget\");\n\n        const cardSystemIcons = document.createElement('div');\n        cardSystemIcons.classList.add(\"card-system-icons\");\n\n        let cardSystemItem;\n\n        cardSystems.forEach(item => {\n            cardSystemItem = document.createElement('img');\n            cardSystemItem.classList.add(\"card-system-item\", \"grey\", item[0]);\n            cardSystemItem.src = item[1];\n            cardSystemItem.alt = item[0];\n\n            cardSystemIcons.appendChild(cardSystemItem);\n        });\n         \n        cardFormWidget.appendChild(cardSystemIcons);\n\n        const control = document.createElement('div');\n        control.classList.add(\"control\");\n\n        control.innerHTML = `\n            <label for=\"card-input\"></label>\n            <input type=\"text\" id=\"card-input\" class=\"input\">\n            <button class=\"submit\">Click to validate</button>\n        `;\n\n        cardFormWidget.appendChild(control);\n\n        return cardFormWidget;\n    }\n\n    static get submitSelector() {\n        return '.submit';\n    }\n\n    static get inputSelector() {\n        return '.input';\n    }\n\n    static get imgSelector() {\n        return '.card-system-item';\n    }\n\n    static get selector() {\n        return '.card-form-widget';\n    }\n\n    bindToDOM() {\n        this.parentEl.append(CardFormWidget.markup(this.cardSystems));\n\n        this.element = this.parentEl.querySelector(CardFormWidget.selector);\n        this.cardSystemElements = this.element.querySelectorAll(CardFormWidget.imgSelector);\n        this.submit = this.element.querySelector(CardFormWidget.submitSelector);\n        this.input = this.element.querySelector(CardFormWidget.inputSelector);\n\n        this.input.addEventListener('input', this.onInput);\n        this.element.addEventListener('submit', this.onSubmit);\n    }\n\n    onSubmit(e) {\n        e.preventDefault();\n\n        const value = this.input.value;\n\n        if(isValidCard(value)) {\n            this.input.classList.add('valid');\n        } else {\n            this.input.classList.remove('valid');\n        }\n    }\n\n    onInput(e) {\n        e.preventDefault();\n        \n        const text = this.input.value;\n        let paySystemName;\n        \n        let systems = this.cardSystems;\n        \n        paySystemName = paySystem(text, systems);\n\n        console.log(paySystemName);\n\n        if (!paySystemName) {\n            if (this.currentCardSystem && !this.currentCardSystem.classList.contains('grey')) {\n                this.currentCardSystem.classList.add('grey');\n            }\n            this.currentCardSystem = null;\n            return;\n        }\n\n        this.cardSystemElements.forEach(elem => {\n            if (elem.classList.contains(paySystemName)) {\n                elem.classList.remove('grey');\n                this.currentCardSystem = elem;\n            }\n        })\n    }\n\n}","export default function isValidCard(value) {\n    const number = value.toString();\n    const digits = number.replace(/\\D/g, '').split('').map(Number);\n    let sum = 0;\n    let isSecond = false;\n\n    for (let i = digits.length - 1; i >= 0; i--) {\n        let digit = digits[i];\n        \n        if (isSecond) {\n            digit *= 2;\n            if (digit > 9) {\n                digit -= 9;\n            }\n        }\n        sum += digit;\n        isSecond = !isSecond;\n    }\n\n    return sum % 10 === 0;\n}","export default function paySystem(value, cardSystems) {\n    let result;\n\n    if (!value) {\n        return;\n    }\n\n    const clean = value.replace(/[+ ()]/g,  ''); // удаляем +; ' ' и т.д.\n    \n    cardSystems.some(item => {\n        item[2].some(number => {\n            if (clean.startsWith(number)) {\n                console.log(item[0]);\n                result = item[0];\n                return;\n            }\n        });\n    })\n\n    return result;\n}","import CardFormWidget from \"../components/form-widget/form-widget\";\n\nconst container = document.querySelector('.container');\nconst form = new CardFormWidget(container);\n\n\nform.bindToDOM();"],"names":["__webpack_require__","g","globalThis","this","Function","e","window","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","i","Error","replace","p","CardFormWidget","constructor","parentEl","onSubmit","bind","onInput","cardSystems","visa","mastercard","americanExpress","discover","jcb","mir","currentCardSystem","markup","cardFormWidget","createElement","classList","add","cardSystemIcons","cardSystemItem","forEach","item","alt","appendChild","control","innerHTML","submitSelector","inputSelector","imgSelector","selector","bindToDOM","append","element","querySelector","cardSystemElements","querySelectorAll","submit","input","addEventListener","preventDefault","value","digits","toString","split","map","Number","sum","isSecond","digit","isValidCard","remove","text","paySystemName","systems","result","clean","some","number","startsWith","console","log","paySystem","contains","elem","container"],"sourceRoot":""}